components:
  parameters:
    aid:
      description: chat answer id
      in: path
      name: aid
      required: true
      schema:
        type: integer
    id:
      description: chat topic id
      in: path
      name: id
      required: true
      schema:
        type: string
    qid:
      description: chat question item id
      in: path
      name: qid
      required: true
      schema:
        type: integer
  schemas:
    AnswersComparison:
      properties:
        aids:
          description: answers to be compared against each other
          items:
            description: answer id
            type: integer
          type: array
        preferredId:
          description: answer id
          type: integer
      type: object
    ErrorResponse:
      properties:
        code:
          description: short code for backend error
          type: string
        message:
          description: user facing message for the error
          type: string
      type: object
    answer:
      properties:
        answeredAt:
          description: answer creation timestamp in UTC
          type: integer
        chartData:
          description: data returned from ML model in csv format to plot visualization
          type: string
        chartSummary:
          description: table name returned by advanced analytics
          type: string
        chartType:
          description: type of data visualization representation
          enum:
            - line
            - spline
            - column
            - area
            - areaspline
            - bar
            - scatter
            - table
          type: string
        content:
          description: answer text
          type: string
        id:
          description: answer
          type: integer
        reference:
          description: reference links to additional information for the answer
          type: string
      type: object
    chatItemData:
      properties:
        id:
          type: integer
        question:
          type: string
      type: object
    chatTopic:
      properties:
        createdAt:
          description: creation timestamp in UTC
          type: integer
        createdBy:
          description: user id that created the chat topic
          type: string
        id:
          description: chat topic id
          type: string
        title:
          description: chat title
          type: string
        updatedAt:
          description: update timestamp in UTC
          type: integer
      type: object
    chatTopicWithItemsAndAnswers:
      properties:
        createdAt:
          description: creation timestamp in UTC
          type: integer
        createdBy:
          description: user id that created the chat topic
          type: string
        id:
          description: chat topic id
          type: string
        items:
          items:
            properties:
              answers:
                description: text answers returned from ML model
                items:
                  $ref: "#/components/schemas/answer"
                type: array
              id:
                description: chat item id
                type: integer
              question:
                description: user's question
                type: string
            type: object
          type: array
        title:
          description: chat title
          type: string
        updatedAt:
          description: update timestamp in UTC
          type: integer
      type: object
    chatTopics:
      items:
        $ref: "#/components/schemas/chatTopic"
      type: array
    feedback:
      description: user's feedback of an answer
      properties:
        comment:
          type: string
        reason:
          type: string
        type:
          description: type of feedback, 1 for positive and -1 for negative
          enum:
            - -1
            - 1
          type: integer
      type: object
    recommendedQuestions:
      items:
        properties:
          question:
            type: string
        type: object
      type: array
    recommendedTitles:
      items:
        properties:
          title:
            type: string
        type: object
      type: array
info:
  contact:
    email: ysun@netskope.com
  description:
    APIs for CRUD operations on skopilot chat topics, questions and answers,
    and customer feedback
  title: Netskope Skopilot Backend endpoints
  version: ""
openapi: 3.0.3
paths:
  /skopilot/chattopics:
    get:
      responses:
        "200":
          content:
            application/json:
              schema:
                example:
                  - createdAt: 1692942842
                    createdBy: abc@efg.com
                    id: ee683adc-4309-11ee-be56-0242ac120002
                    title: What is DLP
                    updatedAt: 1692942842
                  - createdAt: 1692942875
                    createdBy: aaa@efg.com
                    id: ee683adc-4309-11ee-be56-0242ac144442
                    title:
                      Getting the IaaS Malware - Malware by type, CSP, instance,
                      bucket
                    updatedAt: 1692942998
                items:
                  $ref: "#/components/schemas/chatTopics"
                type: array
          description: successful operation
      summary:
        Return ALL the chat topics that current user has created within last
        30 days
      tags:
        - skopilot
    post:
      requestBody:
        content:
          application/json:
            example:
              title: What is DLP
            schema:
              properties:
                title:
                  type: string
              type: object
        required: true
      responses:
        "200":
          content:
            application/json:
              example:
                createdAt: 1692942842
                createdBy: abc@efg.com
                id: ee683adc-4309-11ee-be56-0242ac120002
                title: What is DLP
                updatedAt: 1692942842
              schema:
                $ref: "#/components/schemas/chatTopic"
          description: OK
      summary: Add new chat topic created by user.
      tags:
        - skopilot
    x-netskope-params:
      apiGroup: skopilot-connector
      customerFacing: true
      nsBeta: true
      serviceConfig: skopilot
      version: 2
  /skopilot/chattopics/{id}:
    delete:
      parameters:
        - $ref: "#/components/parameters/id"
      responses:
        "200":
          content:
            application/json:
              schema:
                properties:
                  success:
                    default: true
                    description: whether delete was successful or not
                    type: boolean
                type: object
          description: successful operation
        "404":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Chat topic not found
      summary:
        Delete one chat, including all the contents associated with the chat
        topic
      tags:
        - skopilot
    get:
      parameters:
        - $ref: "#/components/parameters/id"
      responses:
        "200":
          content:
            application/json:
              example:
                createdAt: 1692942842
                createdBy: bbb@def.com
                id: ee683adc-4309-11ee-be56-0242ac120002
                items:
                  - answers:
                      - answeredAt: 1692942899
                        chartData:
                          "alert_event_alert_type,alert_event_event_type,alert_event_action,alert_event_alert_name,alert_event_distinct_user_count

                          uba,sequence,anomaly_detection,Bulk,Delete,1

                          uba,sequence,anomaly_detection,Rare,Event,

                          uba,uba_analytics,anomaly_detection,First,access,for,private,app,Zoom,

                          uba,sequence,anomaly_detection,Bulk,Upload,

                          uba,sequence,anomaly_detection,API,Protection:,Bulk,Download,

                          uba,sequence,anomaly_detection,Bulk,Download,

                          uba,uba_analytics,anomaly_detection,First,access,for,private,app,ssl

                          uba,uba_analytics,anomaly_detection,Unusual,cloud,app,access,Google,Gmail,accessed,by,an,unknown,user

                          uba,uba_analytics,anomaly_detection,First,access,for,private,app,[MS
                          Teams UDP]

                          uba,uba_analytics,anomaly_detection,First,access,for,private,app,udt,5"
                        chartSummary:
                          Getting the top 50 most frequent UEBA alerts in
                          the last 7 days table
                        chartType: table
                        content:
                          These are the top 50 most frequent UEBA alerts in the
                          last 7 days, based on the data you provided. It's worth noting
                          that the frequency of these alerts may vary depending on your
                          specific environment and usage patterns.
                        id: 1
                    id: 1
                    question:
                      Getting the top 50 most frequent UEBA alerts in the last
                      7 days
                  - answers:
                      - answeredAt: 1692952800
                        chartData:
                          "app_info_app_cci_erase_cust_data,,page_event_distinct_app_countNever

                          ,1082

                          Later than a month,287

                          Within a month,46

                          Within a week,22

                          "
                        chartSummary:
                          Getting the number of applications by data deletion
                          terms
                        chartType: table
                        content:
                          'Based on the data provided, we can see that there are
                          1082 applications that have the data deletion term set to "Never".
                          This is the highest number of applications among all the data
                          deletion terms.

                          Additionally, we can see that there are 287 applications that
                          have the data deletion term set to "Later than a month". This
                          is the second highest number of applications among all the data
                          deletion terms. On the other hand, there are only 46 applications
                          that have the data deletion term set to "Within a week". This
                          is the lowest number of applications among all the data deletion
                          terms. Therefore, based on the data provided, we can conclude
                          that the majority of applications (1082) have the data deletion
                          term set to "Never", followed by "Later than a month" (287),
                          and the least number of applications (46) have the data deletion
                          term set to "Within a week".'
                        id: 1
                    id: 2
                    question: Getting the number of applications by data deletion terms
                title: The most frequent UEBA alerts
                updatedAt: 1692942842
              schema:
                $ref: "#/components/schemas/chatTopicWithItemsAndAnswers"
          description: successful operation
        "400":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Invalid request
        "404":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Chat topic not found
      summary: Get all the questions associated with one chat topic
      tags:
        - skopilot
    post:
      parameters:
        - $ref: "#/components/parameters/id"
      requestBody:
        content:
          application/json:
            example:
              question:
                Getting the yesterday's IaaS CSA Alerts by Cloud security
                provider (CSP)
            schema:
              properties:
                question:
                  type: string
              type: object
        required: true
      responses:
        "201":
          content:
            application/json:
              example:
                id: 1
                question:
                  Getting the yesterday's IaaS CSA Alerts by Cloud security
                  provider (CSP)
              schema:
                $ref: "#/components/schemas/chatItemData"
          description: successful operation
        "400":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Invalid request
        "404":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Chat topic not found
      summary: Add a new item in a chat topic
      tags:
        - skopilot
    put:
      parameters:
        - $ref: "#/components/parameters/id"
      requestBody:
        content:
          application/json:
            example:
              title: Questions about DLP
            schema:
              properties:
                title:
                  type: string
              type: object
        required: true
      responses:
        "200":
          content:
            application/json:
              example:
                createdAt: 1692942842
                createdBy: abc@efg.com
                id: ee683adc-4309-11ee-be56-0242ac120002
                title: Questions about DLP
                updatedAt: 1692942992
              schema:
                $ref: "#/components/schemas/chatTopic"
          description: successful operation
        "400":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Invalid request
        "404":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Chat topic not found
      summary: Update chat topic title with the new title given by user
      tags:
        - skopilot
    x-netskope-params:
      apiGroup: skopilot-connector
      customerFacing: true
      nsBeta: true
      serviceConfig: skopilot
      version: 2
  /skopilot/chattopics/{id}/questions/{qid}/answers:
    post:
      parameters:
        - $ref: "#/components/parameters/id"
        - $ref: "#/components/parameters/qid"
      requestBody:
        content:
          application/json:
            example:
              answeredAt: 1692952800
              chartData:
                "app_info_app_cci_erase_cust_data,,page_event_distinct_app_countNever

                ,1082

                Later than a month,287

                Within a month,46

                Within a week,22

                "
              chartSummary: Getting the number of applications by data deletion terms
              chartType: table
              content:
                'Based on the data provided, we can see that there are 1082
                applications that have the data deletion term set to "Never". This
                is the highest number of applications among all the data deletion
                terms.

                Additionally, we can see that there are 287 applications that have
                the data deletion term set to "Later than a month". This is the second
                highest number of applications among all the data deletion terms.
                On the other hand, there are only 46 applications that have the data
                deletion term set to "Within a week". This is the lowest number of
                applications among all the data deletion terms. Therefore, based on
                the data provided, we can conclude that the majority of applications
                (1082) have the data deletion term set to "Never", followed by "Later
                than a month" (287), and the least number of applications (46) have
                the data deletion term set to "Within a week".'
              id: 0
              reference: https://docs.netskope.com/en/netskope-help/data-security/api-data-protection/api-data-protection-for-google-drive/create-an-api-data-protection-policy-118927/
            schema:
              $ref: "#/components/schemas/answer"
        required: true
      responses:
        "201":
          content:
            application/json:
              schema:
                properties:
                  id:
                    type: integer
                type: object
          description: successful operation
        "400":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Invalid request
        "404":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Chat topic not found
      summary: Add a new answer to a question item
      tags:
        - skopilot
    x-netskope-params:
      apiGroup: skopilot-connector
      customerFacing: true
      nsBeta: true
      serviceConfig: skopilot
      version: 2
  /skopilot/chattopics/{id}/questions/{qid}/answers/votes:
    post:
      parameters:
        - $ref: "#/components/parameters/id"
        - $ref: "#/components/parameters/qid"
      requestBody:
        content:
          application/json:
            example:
              aids:
                - 1
                - 2
              preferredId: 2
            schema:
              $ref: "#/components/schemas/AnswersComparison"
        required: true
      responses:
        "201":
          content:
            application/json:
              schema:
                properties:
                  success:
                    default: true
                    description: whether the preferred answer was updated or not
                    type: boolean
                type: object
          description: successful operation
        "400":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Invalid request
        "404":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Chat topic not found
      summary: Post the preferred answer between answers
      tags:
        - skopilot
    x-netskope-params:
      apiGroup: skopilot-connector
      customerFacing: true
      nsBeta: true
      serviceConfig: skopilot
      version: 2
  /skopilot/chattopics/{id}/questions/{qid}/answers/{aid}:
    put:
      parameters:
        - $ref: "#/components/parameters/id"
        - $ref: "#/components/parameters/qid"
        - $ref: "#/components/parameters/aid"
      requestBody:
        content:
          application/json:
            example:
              answeredAt: 1692952800
              chartData:
                "app_info_app_cci_erase_cust_data,,page_event_distinct_app_countNever

                ,1082

                Later than a month,287

                Within a month,46

                Within a week,22

                "
              chartSummary: Getting the number of applications by data deletion terms
              chartType: line
              content:
                'Based on the data provided, we can see that there are 1082
                applications that have the data deletion term set to "Never". This
                is the highest number of applications among all the data deletion
                terms.

                Additionally, we can see that there are 287 applications that have
                the data deletion term set to "Later than a month". This is the second
                highest number of applications among all the data deletion terms.
                On the other hand, there are only 46 applications that have the data
                deletion term set to "Within a week". This is the lowest number of
                applications among all the data deletion terms. Therefore, based on
                the data provided, we can conclude that the majority of applications
                (1082) have the data deletion term set to "Never", followed by "Later
                than a month" (287), and the least number of applications (46) have
                the data deletion term set to "Within a week".'
              id: 1
              reference: https://docs.netskope.com/en/netskope-help/data-security/api-data-protection/api-data-protection-for-google-drive/create-an-api-data-protection-policy-118927/users-117905/
            schema:
              $ref: "#/components/schemas/answer"
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                properties:
                  success:
                    default: true
                    description: whether answer was successfully updated
                    type: boolean
                type: object
          description: successful operation
        "400":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Invalid request
        "404":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Chat topic not found
      summary: Update the given answer to a question item
      tags:
        - skopilot
    x-netskope-params:
      apiGroup: skopilot-connector
      customerFacing: true
      nsBeta: true
      serviceConfig: skopilot
      version: 2
  /skopilot/chattopics/{id}/questions/{qid}/answers/{aid}/feedback:
    post:
      parameters:
        - $ref: "#/components/parameters/id"
        - $ref: "#/components/parameters/qid"
        - $ref: "#/components/parameters/aid"
      requestBody:
        content:
          application/json:
            example:
              comment: This was helpful
              reason: accurate
              type: 1
            schema:
              $ref: "#/components/schemas/feedback"
        required: true
      responses:
        "201":
          content:
            application/json:
              schema:
                properties:
                  success:
                    default: true
                    description: whether feedback creation was successful or not
                    type: boolean
                type: object
          description: successful operation
        "400":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Invalid request
        "404":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Chat topic not found
        "409":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Feedback already exists
      summary: User provide feedback to an answer of a chat item
      tags:
        - skopilot
    x-netskope-params:
      apiGroup: skopilot-connector
      customerFacing: true
      nsBeta: true
      serviceConfig: skopilot
      version: 2
  /skopilot/chattopics/{id}/recommendations:
    get:
      parameters:
        - $ref: "#/components/parameters/id"
      responses:
        "200":
          content:
            application/json:
              example:
                - question: Getting the number of alerts by alert type and date
                - question:
                    Getting the number of alerts by alert type, category and
                    application
                - question: Getting the number of alerts by category and application
                - question: Getting the number of applications allowing data download
              schema:
                $ref: "#/components/schemas/recommendedQuestions"
          description: successful operation
        "404":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Chat topic is not found
      summary: Return the next recommended questions for the current chat topic
      tags:
        - skopilot
    x-netskope-params:
      apiGroup: skopilot-connector
      customerFacing: true
      nsBeta: true
      serviceConfig: skopilot
      version: 2
  /skopilot/chattopics/{id}/titlesuggestions:
    get:
      parameters:
        - $ref: "#/components/parameters/id"
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/recommendedTitles"
          description: successful operation
        "400":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Invalid request
        "404":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Chat topic not found
      summary: Retrieve title suggestions for the topic
      tags:
        - skopilot
    x-netskope-params:
      apiGroup: skopilot-connector
      customerFacing: true
      nsBeta: true
      serviceConfig: skopilot
      version: 2
  /skopilot/sse/chattopics/{id}/questions/{qid}/answer:
    get:
      parameters:
        - $ref: "#/components/parameters/id"
        - $ref: "#/components/parameters/qid"
      responses:
        "200":
          content:
            text/event_stream:
              schema:
                example: "|CHART_DATA|col1,col2,col3,

                  1,2,3,

                  4,5,6|CONTENT|hello, this is the response|CHART_SUMMARY|Getting
                  the IaaS accounts by account IDs, and users|REFERENCE|http://www.gogole.com,www.bing.com,http://netskope.com|COMPLETED|"
                format: event-stream
                type: string
          description: successful operation
        "404":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
          description: Chat topic or item not found
      summary: Get the answer of a question item through an SSE connection
      tags:
        - skopilot
    x-netskope-params:
      apiGroup: skopilot-connector
      customerFacing: true
      nsBeta: true
      readTimeout: 86400000
      serviceConfig: skopilot
      version: 2
tags:
  - description: skopilot rest api
    name: skopilot
