components:
  schemas:
    FileUploadQuery:
      properties:
        filename:
          description: Uploaded file name in full path
          type: string
      required:
        - filename
      type: object
    FpDto:
      properties:
        contentMD5:
          description: Fingerprint text content MD5
          type: string
        contentXXH:
          description: XXhash of the text content
          format: int64
          type: integer
        created:
          default: 0
          description: When the fingerprint is created
          type: integer
        filename:
          description: Fingerprint file full path
          type: string
        fpGroupId:
          description: Fingerprint group ID
          type: string
        fpKey:
          description: Fingerprint file unique key
          type: string
        imageEmbedding:
          description: Fingerprint image embedding
          items:
            format: float
            type: number
          type: array
        isFalPos:
          description: Whether a file is negative sample
          type: boolean
        md5:
          description: Fingerprint file MD5
          type: string
        pHash:
          description: Image fingerprint pHash - size of 4 for 4 straight directions
          items:
            format: int64
            type: integer
          type: array
        simhash:
          description: Fingerprint simhash list - size of 4
          items:
            format: int64
            type: integer
          type: array
        status:
          description: Fingerprint status - active or inactive
          type: string
        tenantId:
          description: Tenant ID
          type: string
        textEmbedding:
          description: Fingerprint text embedding - ML model hash
          items:
            format: float
            type: number
          type: array
        type:
          description: Fingerprint type - image or text
          type: string
        updated:
          default: 0
          description: When the fingerprint was last updated
          type: integer
        xxhash:
          description: XXhash of the fingerprint original file
          format: int64
          type: integer
      required:
        - tenantId
        - fpGroupId
        - filename
        - fpKey
        - md5
      type: object
    FpgDto:
      properties:
        created:
          default: 0
          description: Fingerprint group create time in milliseconds since the epoch
          type: integer
        description:
          description: Fingerprint group description
          type: string
        fpGroupId:
          description: Fingerprint group ID
          type: string
        fpGroupName:
          description: Fingerprint group Name
          type: string
        isPredefined:
          default: false
          description:
            Where the fingerprint-group/custom-classifier is pre-defined
            or custom
          type: boolean
        lastTrained:
          default: 0
          description:
            Fingerprint-group/custom-classifier last trained time in milliseconds
            since the epoch
          type: integer
        lastUploaded:
          default: 0
          description: Last time artifacts were uploaded
          type: integer
        modifyBy:
          description: Fingerprint group modified by which user
          type: string
        profiles:
          description: Referencing DLP profiles
          items:
            type: string
          type: array
        region:
          description: Fingerprint group used region
          type: string
        status:
          description: Fingerprint group status - active, error, etc.
          type: string
        tenantId:
          description: tenant ID
          type: string
        threshold:
          default: 0
          description: Lookup threshold of a given fingerprint-group/custom-classifier
          format: float
          type: number
        type:
          $ref: "#/components/schemas/GroupTypeEnum_String"
          description: Fingerprint group type - image, text, etc.
        updated:
          default: 0
          description:
            Fingerprint group last update time in milliseconds since the
            epoch
          type: integer
        version:
          default: 0
          description:
            Fingerprint group version (user cannot modify) - updates will
            increment the version
          maximum: 2147483647
          minimum: 0
          type: integer
      required:
        - fpGroupId
      type: object
    GroupProfileDto:
      properties:
        profiles:
          description: List of referenced profiles
          items:
            type: string
          type: array
      required:
        - profiles
      type: object
    GroupTypeEnum_String:
      enum:
        - image
        - text
        - simclr
        - simhash
        - mlv1
      type: string
    PredefinedClassCategoryDto:
      properties:
        id:
          description: Category ID
          type: string
        label:
          description: Category label
          type: string
      required:
        - id
      type: object
    PredefinedClassEntryDto:
      properties:
        category_ref:
          type: string
        description:
          type: string
        dlp_license:
          description: DLP license level
          type: string
        id:
          description: The unique name for this pre-defined classifier
          type: string
        label:
          description: Short description
          type: string
        model_type:
          description: image, text, etc.
          type: string
        search_refs:
          description: Referenced search key list
          items:
            type: string
          type: array
        search_tags:
          type: string
      required:
        - id
      type: object
    PredefinedClassSearchDataDto:
      properties:
        data:
          description: Search token list separated by comma
          type: string
        id:
          description: Search key ID
          type: string
      required:
        - id
      type: object
    PredefinedClassesDto:
      properties:
        categories:
          items:
            $ref: "#/components/schemas/PredefinedClassCategoryDto"
          type: array
        classifiers:
          description: List of classifier entries
          items:
            $ref: "#/components/schemas/PredefinedClassEntryDto"
          type: array
        search_data:
          items:
            $ref: "#/components/schemas/PredefinedClassSearchDataDto"
          type: array
      required:
        - classifiers
      type: object
    PredefinedClassifierNameEnum_String:
      enum:
        - driver_license-us
        - passport
        - screenshot
        - resume-en_us
        - ma_form-en_us
        - tax_form-en_us
        - social_security_card-us
        - payment_card
        - whiteboard
        - offer_letter
        - consulting_agreement
        - partner_agreement
        - nda
        - patent-en_us
        - bank_statement
        - stock_purchase_agreement
        - source_code
        - medical_poa
        - healthcare_id_card
        - check
        - driver_license
        - photo_id
        - medical_form
        - loan_agreement
        - medical_image
        - loan_application
      type: string
    PredefinedClassifierUserDto:
      properties:
        description:
          description: Predefined classifier description
          type: string
        modifyBy:
          description: The last user who modified the predefined classifier
          type: string
        name:
          $ref: "#/components/schemas/PredefinedClassifierNameEnum_String"
          description: Predefined classifier name
        thresholdLevel:
          $ref: "#/components/schemas/PredefinedThreshLevelEnum_String"
          default: medium
          description:
            Lookup threshold level of predefined classifier - low, medium,
            medium-high and high
      required:
        - name
        - thresholdLevel
      type: object
    PredefinedClassifiersWithOverlayDto:
      properties:
        overlayCustomClassifiers:
          description:
            A list overlay (hidden) custom classifiers each corresponding
            to a pre-defined classifier
          items:
            $ref: "#/components/schemas/PredefinedOverlayDto"
          type: array
        predefinedClassifiers:
          $ref: "#/components/schemas/PredefinedClassesDto"
          description: Detailed information about pre-defined classifiers
      required:
        - predefinedClassifiers
      type: object
    PredefinedOverlayDto:
      properties:
        created:
          default: 0
          description:
            When custom classifier was created, milliseconds since the
            epoch
          type: integer
        description:
          description: Custom classifier description
          type: string
        id:
          description: Custom classifier ID
          type: string
        isPredefined:
          default: false
          description: Whether classifier is pre-defined
          type: boolean
        lastTrained:
          default: 0
          description:
            When custom classifier was last trained, milliseconds since
            the epoch
          type: integer
        modifyBy:
          description: Last user modified custom classifier
          type: string
        name:
          description: Custom classifier name
          type: string
        overallStatus:
          $ref: "#/components/schemas/TyocOverallStatus"
          description: The overall status object
        profiles:
          description: "Referenced profiles for the custom classifier "
          items:
            type: string
          type: array
        region:
          description: Custom classifier deploy region
          type: string
        status:
          description: Custom classifier status - active, error, etc.
          type: string
        tenantId:
          description: Tenant ID
          type: string
        threshold:
          default: 0
          description: Lookup threshold
          format: float
          type: number
        thresholdLevel:
          $ref: "#/components/schemas/PredefinedThreshLevelEnum_String"
          description:
            Lookup threshold level of predefined classifier - low, medium,
            medium-high and high
        type:
          $ref: "#/components/schemas/GroupTypeEnum_String"
          description:
            Custom classifier type - image or text, other options are for
            backwards compatibility and will be removed in the future
        updated:
          default: 0
          description:
            When custom classifier was last updated, milliseconds since
            the epoch
          type: integer
        version:
          default: 0
          description:
            Custom classifier version (user cannot modify) - an update
            will increment it
          maximum: 2147483647
          minimum: 0
          type: integer
      required:
        - id
        - threshold
        - thresholdLevel
      type: object
    PredefinedThreshLevelEnum_String:
      enum:
        - low
        - medium
        - medium-high
        - high
      type: string
    TyocClassArrayDto:
      properties:
        customClassifiers:
          description: List of custom classifiers
          items:
            $ref: "#/components/schemas/TyocClassifierPresentDto"
          type: array
      required:
        - customClassifiers
      type: object
    TyocClassifierDto:
      properties:
        created:
          default: 0
          description:
            When custom classifier was created, milliseconds since the
            epoch
          type: integer
        description:
          description: Custom classifier description
          type: string
        id:
          description: Custom classifier ID
          type: string
        isPredefined:
          default: false
          description: Whether classifier is pre-defined
          type: boolean
        lastTrained:
          default: 0
          description:
            When custom classifier was last trained, milliseconds since
            the epoch
          type: integer
        modifyBy:
          description: Last user modified custom classifier
          type: string
        name:
          description: Custom classifier name
          type: string
        profiles:
          description: "Referenced profiles for the custom classifier "
          items:
            type: string
          type: array
        region:
          description: Custom classifier deploy region
          type: string
        status:
          description: Custom classifier status - active, error, etc.
          type: string
        tenantId:
          description: Tenant ID
          type: string
        threshold:
          default: 0
          description: Lookup threshold
          format: float
          type: number
        type:
          $ref: "#/components/schemas/GroupTypeEnum_String"
          description:
            Custom classifier type - image or text, other options are for
            backwards compatibility and will be removed in the future
        updated:
          default: 0
          description:
            When custom classifier was last updated, milliseconds since
            the epoch
          type: integer
        version:
          default: 0
          description:
            Custom classifier version (user cannot modify) - an update
            will increment it
          maximum: 2147483647
          minimum: 0
          type: integer
      required:
        - id
        - threshold
      type: object
    TyocClassifierPresentDto:
      properties:
        created:
          default: 0
          description:
            When was the custom classifier created, milliseconds since
            the epoch
          type: integer
        description:
          description: Custom classifier description
          type: string
        id:
          description: Custom classifier ID
          type: string
        isPredefined:
          default: false
          description: Whether the class is pre-defined
          type: boolean
        lastTrained:
          default: 0
          description: When was the custom classifier last trained
          type: integer
        modifyBy:
          description: User who last modified the custom class
          type: string
        name:
          description: Custom classifier name
          type: string
        overallStatus:
          $ref: "#/components/schemas/TyocOverallStatus"
          description: The overall status object
        region:
          description: Custom classifier deploy region
          type: string
        status:
          description: Custom classifier status - active, error, etc.
          type: string
        threshold:
          default: 0
          description: Lookup threshold for custom class
          format: float
          type: number
        thresholdLevel:
          $ref: "#/components/schemas/PredefinedThreshLevelEnum_String"
          description:
            Lookup threshold level of predefined classifier - low, medium,
            medium-high and high
        type:
          $ref: "#/components/schemas/GroupTypeEnum_String"
          description:
            Custom classifier type - image or text, other options are for
            backwards compatibility and will be removed in the future
        updated:
          default: 0
          description:
            When was the custom classifier last updated, milliseconds since
            the epoch
          type: integer
        version:
          default: 0
          description:
            Custom classifier version (user cannot modify) - an update
            will increment it
          maximum: 2147483647
          minimum: 0
          type: integer
      required:
        - id
        - name
        - threshold
      type: object
    TyocFileArrayDto:
      properties:
        validFiles:
          description: Valid file list
          items:
            $ref: "#/components/schemas/TyocFileDto"
          type: array
      required:
        - validFiles
      type: object
    TyocFileDto:
      properties:
        classId:
          description: Custom classifier ID
          type: string
        created:
          default: 0
          description:
            When the file was created (first uploaded), milliseconds since
            the epoch
          type: integer
        fileKey:
          description: Unique key to identify a trained file
          type: string
        filename:
          description: Filename of the uploaded artifact
          type: string
        hash:
          description: File hash, default to MD5
          type: string
        isFalPos:
          description: Whether the file is a negative sample
          type: boolean
        updated:
          default: 0
          description: When the file was last updated, milliseconds since the epoch
          type: integer
      required:
        - classId
        - filename
        - fileKey
        - isFalPos
      type: object
    TyocOverallStatus:
      properties:
        errMsg:
          description: Error message if any
          type: string
        invalid:
          default: 0
          description: Count of invalid training files
          maximum: 2147483647
          minimum: 0
          type: integer
        negative:
          default: 0
          description: Count of negative training files
          maximum: 2147483647
          minimum: 0
          type: integer
        valid:
          default: 0
          description: Count of valid training files
          maximum: 2147483647
          minimum: 0
          type: integer
      required:
        - valid
        - negative
      type: object
    TyocQueryDto:
      properties:
        filename:
          description: Uploaded file name in full path
          type: string
        id:
          description: Custom classifier ID
          type: string
      required:
        - id
        - filename
      type: object
    TyocStatusFingerprintPresentDto:
      properties:
        filename:
          description: File name uploaded artifact
          type: string
        status:
          description: Status of an artifact - active or inactive
          type: string
        type:
          description: Type of an artifact - image, text, etc.
          type: string
      required:
        - filename
      type: object
    TyocUploadStatusDto:
      properties:
        fingerprints:
          description: Generated fingerprint details
          items:
            $ref: "#/components/schemas/TyocStatusFingerprintPresentDto"
          type: array
        id:
          description: Custom classifier ID
          type: string
        isFalPos:
          description: Is the upload for negative samples
          type: boolean
        lastUpdate:
          description: Last updated time for this upload
          type: integer
        msg:
          description: Descriptive message given to an upload
          type: string
        ssid:
          description: Upload session ID
          type: string
        status:
          description: Upload status - successful or error
          type: string
        txid:
          description: Upload transmit ID
          type: string
        uploadFile:
          description: Upload file name with full path
          type: string
      required:
        - id
      type: object
    TyocUploadStatusListDto:
      properties:
        uploads:
          description: List of uploads
          items:
            $ref: "#/components/schemas/TyocUploadStatusDto"
          type: array
      required:
        - uploads
      type: object
    TyocUserDto:
      properties:
        description:
          description: Custom classifier description
          type: string
        modifyBy:
          description: The last user who modified the custom classifier
          type: string
        name:
          description: Custom classifier name
          type: string
        threshold:
          default: 0
          description: Lookup threshold of custom classifier
          format: float
          type: number
        type:
          $ref: "#/components/schemas/GroupTypeEnum_String"
          description:
            Custom classifier type - image or text, other options are for
            backwards compatibility and will be removed in the future
      required:
        - name
        - type
        - threshold
      type: object
info:
  contact:
    name: Wayne Xin
    url: https://waynexin.com/
  description: Management page for 2.0 fingerprints
  title: Fingerprinting Management Service
  version: "1.0"
openapi: 3.0.0
paths:
  /services/dlp/classifiers/custom:
    get:
      description:
        This API supports pagination and a reverse ordered list by classifier
        update time is returned
      operationId: gwGetAllTyocClassesV2
      parameters:
        - deprecated: false
          description: offset of a large result, default to 0
          in: query
          name: offset
          required: false
          schema:
            maximum: 2147483647
            minimum: 0
            type: integer
        - deprecated: false
          description: batch size of each result, default to 0
          in: query
          name: limit
          required: false
          schema:
            maximum: 2147483647
            minimum: 0
            type: integer
        - deprecated: false
          description:
            whether to limit to custom classifiers only, default to false
            meaning retrieve both custom and predefined classifiers
          in: query
          name: customOnly
          required: false
          schema:
            type: boolean
      responses:
        "200":
          content:
            application/json:
              examples:
                Mixed classifiers:
                  value:
                    ' {   "customClassifiers": [     {       "id": "4212644500771208587",       "name":
                    "WayneImageUpdate79",       "status": "error",       "type": "image",       "description":
                    "Xin update Dec19 update",       "version": 11,       "region":
                    null,       "modifyBy": "wxin@netskope.com",       "isPredefined":
                    false,       "threshold": 0.7900000214576721,       "created":
                    1703049910671,       "updated": 1703050052813,       "lastTrained":
                    1703054175597,       "thresholdLevel": null,       "overallStatus":
                    {         "invalid": 0,         "valid": 8,         "negative":
                    0,         "errMsg": "Insufficient artifacts in training"       }     },     {       "id":
                    "144294124833494081",       "name": "_overlay_medical_image",       "status":
                    "ready",       "type": "image",       "description": "test threshold
                    level change",       "version": 1,       "region": null,       "modifyBy":
                    "wxin@netskope.com",       "isPredefined": true,       "threshold":
                    0,       "created": 1702782844179,       "updated": 1703047822861,       "lastTrained":
                    1703101168724,       "thresholdLevel": "medium-high",       "overallStatus":
                    {         "invalid": 0,         "valid": 1,         "negative":
                    1,         "errMsg": null       }     },     {       "id": "6195603838228410235",       "name":
                    "_overlay_loan_agreement",       "status": "created",       "type":
                    "image",       "description": "test V2 on Dec 19",       "version":
                    0,       "region": null,       "modifyBy": "wxin@netskope.com",       "isPredefined":
                    true,       "threshold": 0,       "created": 1703004950701,       "updated":
                    1703047696392,       "lastTrained": 0,       "thresholdLevel":
                    "medium",       "overallStatus": {         "invalid": 0,         "valid":
                    0,         "negative": 0,         "errMsg": null       }     },     {       "id":
                    "7055188584674019609",       "name": "Bob Xray Chest",       "status":
                    "ready",       "type": "image",       "description": "test V2
                    on Nov 1st",       "version": 1,       "region": null,       "modifyBy":
                    "wxin@netskope.com",       "isPredefined": false,       "threshold":
                    0.4000000059604645,       "created": 1698878808044,       "updated":
                    1698878808044,       "lastTrained": 1698878920776,       "thresholdLevel":
                    null,       "overallStatus": {         "invalid": 0,         "valid":
                    30,         "negative": 0,         "errMsg": null       }     }   ]
                    } '
                Only custom classifiers:
                  value:
                    ' {   "customClassifiers": [     {       "id": "5811976269388497234",       "name":
                    "WayneImageUpdate9",       "status": "ready",       "type": "image",       "description":
                    "Xin update Oct26 update",       "version": 2,       "region":
                    null,       "modifyBy": "wxin@netskope.com",       "isPredefined":
                    false,       "threshold": 0.5,       "created": 1698879272474,       "updated":
                    1698956670658,       "lastTrained": 1698956670760,       "overallStatus":
                    {         "invalid": 0,         "valid": 30,         "negative":
                    0,         "errMsg": null       }     },     {       "id": "7055188584674019609",       "name":
                    "Bob Xray Chest",       "status": "ready",       "type": "image",       "description":
                    "test V2 on Nov 1st",       "version": 1,       "region": null,       "modifyBy":
                    "wxin@netskope.com",       "isPredefined": false,       "threshold":
                    0.4000000059604645,       "created": 1698878808044,       "updated":
                    1698878808044,       "lastTrained": 1698878920776,       "overallStatus":
                    {         "invalid": 0,         "valid": 30,         "negative":
                    0,         "errMsg": null       }     },     {       "id": "321461180847334381",       "name":
                    "Wayne Test V2",       "status": "error",       "type": "image",       "description":
                    "test V2 on Oct 30",       "version": 2,       "region": null,       "modifyBy":
                    "wxin@netskope.com",       "isPredefined": false,       "threshold":
                    0.800000011920929,       "created": 1698690293834,       "updated":
                    1698690293834,       "lastTrained": 1698690780807,       "overallStatus":
                    {         "invalid": 0,         "valid": 0,         "negative":
                    0,         "errMsg": "Insufficient artifacts in training"       }     }   ]
                    } '
              schema:
                $ref: "#/components/schemas/TyocClassArrayDto"
          description:
            Each classifier is returned with a classifier ID (id). This
            id can be used for classifier specific APIs
        "404":
          content:
            text/plain:
              schema:
                type: string
          description: Not Found
        "500":
          content:
            text/plain:
              schema:
                type: string
          description: Internal Server Error
      summary: Get all custom classifiers
      tags:
        - tyoc-v2
    post:
      description:
        Creating a custom classifier requires a unique name for a given
        tenant and a classifier ID will be returned for future reference
      operationId: gwCreateTyocClassV2
      parameters: []
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/TyocUserDto"
        required: true
      responses:
        "200":
          content:
            application/json:
              examples:
                Successful Response_1:
                  value:
                    ' {   "id": "5555383037969464020",   "name": "ApiGateway
                    Late night Jul13",   "status": "created",   "type": "image",   "description":
                    "test update",   "version": 0,   "region": null,   "modifyBy":
                    "john.smith@netskope.com",   "threshold": 0.8500000238418579,   "created":
                    1689376598488,   "updated": 1689376598488,   "lastTrained": 0
                    } '
              schema:
                $ref: "#/components/schemas/TyocClassifierDto"
          description:
            A classifier ID is returned and this could be used for classifier
            specific API
        "404":
          content:
            text/plain:
              schema:
                type: string
          description: Not Found
        "500":
          content:
            text/plain:
              schema:
                type: string
          description: Internal Server Error
      summary: Create new custom classifier
      tags:
        - tyoc-v2
    x-netskope-params:
      apiGroup: tyoc
      customerFacing: true
      serviceConfig: dlp-fp-config
      version: 2
  /services/dlp/classifiers/custom/{id}:
    delete:
      description:
        The custom classifier and all its uploaded artifact features will
        be deleted
      operationId: gwDeleteTyocClassV2
      parameters:
        - deprecated: false
          description: classifier ID obtained from classifier retrieval APIs
          in: path
          name: id
          required: true
          schema:
            type: string
      responses:
        "200":
          content:
            text/plain:
              examples:
                Successful Response_1:
                  value:
                    ' {     "result": "deleted 2400_1419617902758911195, FP deleted:
                    0" }     '
              schema:
                type: string
          description:
            "'FP deleted' indicates the number all valid uploaded files
            deleted"
        "404":
          content:
            text/plain:
              schema:
                type: string
          description: Not Found
        "500":
          content:
            text/plain:
              schema:
                type: string
          description: Internal Server Error
      summary: Delete a custom classifier by class ID
      tags:
        - tyoc-v2
    get:
      description:
        The required classifier ID is obtained from create/update and retrieval
        APIs offered by this service
      operationId: gwGetTyocClassV2
      parameters:
        - deprecated: false
          description: Custom classifier ID obtained from an classifier retrieval API
          in: path
          name: id
          required: true
          schema:
            type: string
      responses:
        "200":
          content:
            application/json:
              examples:
                Successful Response_1:
                  value:
                    ' {   "id": "5811976269388497234",   "name": "WayneImageUpdate9",   "status":
                    "ready",   "type": "image",   "description": "Xin update Oct26
                    update",   "version": 2,   "region": null,   "modifyBy": "wxin@netskope.com",   "isPredefined":
                    false,   "threshold": 0.5,   "created": 1698879272474,   "updated":
                    1699639990193,   "lastTrained": 1698956670760,   "overallStatus":
                    {     "invalid": 0,     "valid": 30,     "negative": 0,     "errMsg":
                    null   } } '
              schema:
                $ref: "#/components/schemas/TyocClassifierPresentDto"
          description:
            created, lastUploaded, lastTrained are milliseconds from the
            epoch
        "404":
          content:
            text/plain:
              schema:
                type: string
          description: Not Found
        "500":
          content:
            text/plain:
              schema:
                type: string
          description: Internal Server Error
      summary: Get single custom classifier by its ID
      tags:
        - tyoc-v2
    put:
      description:
        Updating a custom classifer needs a classifier ID obtained from
        GET API's
      operationId: gwUpdateTyocClassV2
      parameters:
        - deprecated: false
          description: Classifier ID obtained from classifier retrieval APIs
          in: path
          name: id
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/TyocUserDto"
        required: true
      responses:
        "200":
          content:
            application/json:
              examples:
                Successful Response_1:
                  value:
                    ' {   "tenantId": null,   "id": "5811976269388497234",   "name":
                    "WayneImageUpdate9",   "status": "ready",   "type": "image",   "description":
                    "Xin update Oct26 update",   "version": 2,   "region": null,   "modifyBy":
                    "wxin@netskope.com",   "isPredefined": false,   "threshold": 0.5,   "created":
                    1698879272474,   "updated": 1699639990193,   "lastTrained": 1698956670760,   "profiles":
                    null }     '
              schema:
                $ref: "#/components/schemas/TyocClassifierDto"
          description:
            When updating a classifier, one cannot convert a pre-defined
            to custom or vice versa. 'isPredefined' cannot change from previous value
      summary: Update a custom classifier by classifier ID
      tags:
        - tyoc-v2
    x-netskope-params:
      apiGroup: tyoc
      customerFacing: true
      serviceConfig: dlp-fp-config
      version: 2
  /services/dlp/classifiers/custom/{id}/files:
    delete:
      description: All previous uploaded files will be deleted
      operationId: gwDeleteAllTyocFile
      parameters:
        - deprecated: false
          description: classifier ID obtained from classifier retrieval APIs
          in: path
          name: id
          required: true
          schema:
            type: string
      responses:
        "200":
          content:
            text/plain:
              examples:
                Successful Response_1:
                  value:
                    ' {   "result": "deleted files: 1 for class/group: 36762005058187445"
                    } '
              schema:
                type: string
          description: OK
        "404":
          content:
            text/plain:
              schema:
                type: string
          description: Not Found
        "500":
          content:
            text/plain:
              schema:
                type: string
          description: Internal Server Error
      summary: Delete all files for a custom classifier
      tags:
        - tyoc-v2
    get:
      description:
        A file key will be returned for each file object and the key could
        be used for file specific API
      operationId: gwGetTyocFiles
      parameters:
        - deprecated: false
          description: Custom class ID
          in: path
          name: id
          required: true
          schema:
            type: string
      responses:
        "200":
          content:
            application/json:
              examples:
                Successful Response_1:
                  value:
                    ' {   "validFiles": [     {       "tenantId": null,       "classId":
                    "8547030565787252272",       "filename": "/tmp/demo/test/example.jpg",       "fileKey":
                    "1088447293440",       "hash": "edeee1f50c09feea2a2b31f0b322b189",       "isFalPos":
                    false,       "created": 1696468862067,       "updated": 1696468862067     },     {       "tenantId":
                    null,       "classId": "8547030565787252272",       "filename":
                    "/tmp/demo/training/Bose_SurroundSpeakers.png",       "fileKey":
                    "308151810560",       "hash": "441455fb557d8f6ef1fe323191d1a3a6",       "isFalPos":
                    false,       "created": 1693420832685,       "updated": 1693420832685     }   ]
                    } '
              schema:
                $ref: "#/components/schemas/TyocFileArrayDto"
          description:
            Each file will have a file key and this key could be used for
            file specific API such as deletion
        "404":
          content:
            text/plain:
              schema:
                type: string
          description: Not Found
        "500":
          content:
            text/plain:
              schema:
                type: string
          description: Internal Server Error
      summary: Get valid files by classifier ID
      tags:
        - tyoc-v2
    post:
      description:
        "Optional parameters: ?txid=transmit_id&ssid=session_id&negative=false&sessionend=true
        where 'name' in multipart body is the full path of the uploading file "
      operationId: gwTyocUploadV2
      parameters:
        - deprecated: false
          description: Classifier ID obtained from an classifier retrieval API
          in: path
          name: id
          required: true
          schema:
            type: string
        - deprecated: false
          description: transmit ID
          in: query
          name: txid
          required: false
          schema:
            type: string
        - deprecated: false
          description: session ID of a upload session
          in: query
          name: ssid
          required: false
          schema:
            type: string
        - deprecated: false
          description: whether uploaded sample artifact is negative. Default is false
          in: query
          name: negative
          required: false
          schema:
            type: boolean
        - deprecated: false
          description:
            whether this tansmit is the last of the session, if yes, training
            will be triggered. Default is false
          in: query
          name: sessionend
          required: false
          schema:
            type: boolean
      requestBody:
        content:
          multipart/form-data:
            schema:
              format: binary
              type: string
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                type: string
          description: OK
        "404":
          content:
            text/plain:
              schema:
                type: string
          description: Not Found
        "500":
          content:
            text/plain:
              schema:
                type: string
          description: Internal Server Error
      summary: Upload raw file for custom classifier by ID
      tags:
        - tyoc-v2
    x-netskope-params:
      apiGroup: tyoc
      customerFacing: true
      rateLimit:
        readRoutes:
          second: 20
        writeRoutes:
          second: 20
      serviceConfig: dlp-fp-config
      version: 2
  /services/dlp/classifiers/custom/{id}/files/{key}:
    delete:
      description: A particular file with a given key is deleted
      operationId: gwDeleteTyocFile
      parameters:
        - deprecated: false
          description: classifier ID obtained from classifier retrieval APIs
          in: path
          name: id
          required: true
          schema:
            type: string
        - deprecated: false
          description: file key obtained from file retrieval API
          in: path
          name: key
          required: true
          schema:
            type: string
      responses:
        "200":
          content:
            text/plain:
              examples:
                Successful Response_1:
                  value:
                    ' {     "result": "deleted file: 244852157440 for group:
                    8547030565787252272" } '
              schema:
                type: string
          description: OK
        "404":
          content:
            text/plain:
              schema:
                type: string
          description: Not Found
        "500":
          content:
            text/plain:
              schema:
                type: string
          description: Internal Server Error
      summary: Delete a file for a custom classifier
      tags:
        - tyoc-v2
    x-netskope-params:
      apiGroup: tyoc
      customerFacing: true
      serviceConfig: dlp-fp-config
      version: 2
  /services/dlp/classifiers/custom/{id}/getuploadstatus:
    post:
      description:
        "The classifier ID is obtained from classifier retrieval API's
        and the filename in payload "
      operationId: gwCheckTyocUploadV2
      parameters:
        - deprecated: false
          description: Classifier ID
          in: path
          name: id
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/FileUploadQuery"
        required: true
      responses:
        "200":
          content:
            application/json:
              examples:
                Successful Response_1:
                  value:
                    ' {   "uploads": [     {       "id": "9095141720424589398",       "msg":
                    null,       "txid": "2342343234324",       "ssid": "0",       "status":
                    null,       "isFalPos": null,       "lastUpdate": 1693437483230,       "uploadFile":
                    "/tmp/demo/training/Bose_A20_Aviation_headset.jpeg",       "fingerprints":
                    [         {           "filename": "/tmp/demo/training/Bose_A20_Aviation_headset.jpeg",           "status":
                    "created",           "type": "image"         }       ]     }   ]
                    }  '
              schema:
                $ref: "#/components/schemas/TyocUploadStatusListDto"
          description:
            Since the uploaded file could be an archive, check for 'fingerprints'
            array for individual file upload status
        "404":
          content:
            text/plain:
              schema:
                type: string
          description: Not Found
        "500":
          content:
            text/plain:
              schema:
                type: string
          description: Internal Server Error
      summary: Check custom classifier artifact upload status with given file name
      tags:
        - tyoc-v2
    x-netskope-params:
      apiGroup: tyoc
      customerFacing: true
      rateLimit:
        readRoutes:
          second: 20
        writeRoutes:
          second: 20
      serviceConfig: dlp-fp-config
      version: 2
  /services/dlp/classifiers/custom/{id}/hashes:
    post:
      description:
        "User may split a large hash file into smaller files (by line)
        and upload one at a time to avoid exceeding API upload limits. Use one session
        with multiple transmits. Optional parameters: ?txid=transmit_id&ssid=session_id&negative=false&sessionend=true
        where 'name' in multipart body is the full path of the uploading file "
      operationId: gwTyocHashUpload
      parameters:
        - deprecated: false
          description: Classifier ID obtained from an classifier retrieval API
          in: path
          name: id
          required: true
          schema:
            type: string
        - deprecated: false
          description: transmit ID
          in: query
          name: txid
          required: false
          schema:
            type: string
        - deprecated: false
          description: session ID of a upload session
          in: query
          name: ssid
          required: false
          schema:
            type: string
        - deprecated: false
          description: whether uploaded hashes are negative. Default is false
          in: query
          name: negative
          required: false
          schema:
            type: boolean
        - deprecated: false
          description:
            whether this tansmit is the last of the session, if yes, all
            uploaded files will be processed. Default is false
          in: query
          name: sessionend
          required: false
          schema:
            type: boolean
      requestBody:
        content:
          multipart/form-data:
            schema:
              format: binary
              type: string
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                type: string
          description: OK
        "404":
          content:
            text/plain:
              schema:
                type: string
          description: Not Found
        "500":
          content:
            text/plain:
              schema:
                type: string
          description: Internal Server Error
      summary: Upload hash file for custom classifier by ID
      tags:
        - tyoc-v2
    x-netskope-params:
      apiGroup: tyoc
      customerFacing: true
      serviceConfig: dlp-fp-config
      version: 2
  /services/dlp/classifiers/custom/{id}/profiles:
    post:
      description:
        set the referenced profiles of a class so that when class delete
        is requested, an integrity check is performed. The 'id' is obtained from classifier
        retrieval API's
      operationId: gwSetProfile
      parameters:
        - deprecated: false
          description: Class ID
          in: path
          name: id
          required: true
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/GroupProfileDto"
        required: true
      responses:
        "200":
          content:
            application/json:
              examples:
                Successful Response_1:
                  value:
                    ' {   "tenantId": null,   "id": "9095141720424589398",   "name":
                    "ApiGateway_Wayne_Demo_Test",   "status": "created",   "type":
                    "image",   "description": "test for demo",   "version": 0,   "region":
                    null,   "modifyBy": "wxin@netskope.com",   "threshold": 0.75,   "created":
                    1692898965370,   "updated": 1692898965370,   "lastTrained": 0,   "profiles":
                    [     "1",     "2",     "3"   ] } '
              schema:
                $ref: "#/components/schemas/TyocClassifierDto"
          description:
            The profile ID list is returned as property of the classifier
            object
        "404":
          content:
            text/plain:
              schema:
                type: string
          description: Not Found
        "500":
          content:
            text/plain:
              schema:
                type: string
          description: Internal Server Error
      summary: set profiles for a given custom classifier
      tags:
        - tyoc-v2
    x-netskope-params:
      apiGroup: tyoc
      customerFacing: true
      serviceConfig: dlp-fp-config
      version: 2
  /services/dlp/classifiers/predefined:
    get:
      description:
        The pre-defined classifiers will not have an internal assigned
        ID. The classifier names (ids) are unique among all pre-defined classifiers
      operationId: gwGetAllPredClasses
      parameters: []
      responses:
        "200":
          content:
            application/json:
              examples:
                Successful Response_1:
                  value:
                    ' {   "predefinedClassifiers": {     "categories": [       {         "id":
                    "nsFINANCIAL",         "label": "Financial"       },       {         "id":
                    "nsHR",         "label": "HR"       },       {         "id": "nsLEGAL",         "label":
                    "Legal"       },       {         "id": "nsMEDICAL",         "label":
                    "Medical"       },       {         "id": "nsMISCELLANEOUS",         "label":
                    "Miscellaneous"       },       {         "id": "nsPERSONALID",         "label":
                    "Personal Identifiers"       },       {         "id": "nsSOURCECODE",         "label":
                    "Source Code"       }     ],     "classifiers": [       {         "category_ref":
                    "nsPERSONALID",         "description": "Detects images of driver
                    licenses and state ID cards issued within the United States.",         "dlp_license":
                    "advanced",         "id": "driver_license-us",         "label":
                    "Driver License (US) ",         "model_type": "image",         "search_refs":
                    [           "search/drivlic",           "search/us"         ]       },       {         "category_ref":
                    "nsPERSONALID",         "description": "Detects passport books
                    issued by a variety of different countries.",         "dlp_license":
                    "advanced",         "id": "passport",         "label": "Passport
                    Book",         "model_type": "image",         "search_tags": "passports"       },       {         "category_ref":
                    "nsMISCELLANEOUS",         "description": "Detects screenshots
                    or captures.",         "dlp_license": "advanced",         "id":
                    "screenshot",         "label": "Screenshot",         "model_type":
                    "image",         "search_tags": "screen,screen capture,screen
                    grab,screencapture,screengrab,screenshot"       },       {         "category_ref":
                    "nsHR",         "description": "Detects résumés in English.",         "dlp_license":
                    "standard",         "id": "resume-en_us",         "label": "Résumé",         "model_type":
                    "text",         "search_tags": "employees,english,hr,human resources,resumes,résumés"       },       {         "category_ref":
                    "nsLEGAL",         "description": "Detects merger and acquisition
                    filings.",         "dlp_license": "advanced",         "id": "ma_form-en_us",         "label":
                    "Mergers and Acquisitions Form [M&A] ",         "model_type":
                    "text",         "search_tags": "acquisition,english,m&a,merger,mergers"       },       {         "category_ref":
                    "nsFINANCIAL",         "description": "Detects tax forms used
                    in the United States.",         "dlp_license": "advanced",         "id":
                    "tax_form-en_us",         "label": "Tax Form (US) ",         "model_type":
                    "text",         "search_refs": [           "search/us"         ],         "search_tags":
                    "1040,irs,tax,tax form"       },       {         "category_ref":
                    "nsPERSONALID",         "description": "Detects images of Social
                    Security Cards issued in the United States.",         "dlp_license":
                    "advanced",         "id": "social_security_card-us",         "label":
                    "Social Security Card (US) ",         "model_type": "image",         "search_refs":
                    [           "search/ssn",           "search/us"         ]       },       {         "category_ref":
                    "nsFINANCIAL",         "description": "Detects images of payment
                    cards, including credit and debit cards.",         "dlp_license":
                    "advanced",         "id": "payment_card",         "label": "Payment
                    Card (Credit, Debit) ",         "model_type": "image",         "search_refs":
                    [           "search/pan"         ]       },       {         "category_ref":
                    "nsMISCELLANEOUS",         "description": "Detects images of whiteboards.",         "dlp_license":
                    "advanced",         "id": "whiteboard",         "label": "Whiteboard",         "model_type":
                    "image"       },       {         "category_ref": "nsHR",         "description":
                    "Detects employment offer letters.",         "dlp_license": "advanced",         "id":
                    "offer_letter",         "label": "Offer Letter",         "model_type":
                    "text",         "search_tags": "employees,employment,english,hr,human
                    resources,job offer,offer,offer letter"       },       {         "category_ref":
                    "nsLEGAL",         "description": "Detects consulting agreements.",         "dlp_license":
                    "advanced",         "id": "consulting_agreement",         "label":
                    "Consulting Agreement",         "model_type": "text",         "search_tags":
                    "agreements,consulting,contracts,english,service contracts"       },       {         "category_ref":
                    "nsLEGAL",         "description": "Detects partner agreements.",         "dlp_license":
                    "advanced",         "id": "partner_agreement",         "label":
                    "Partner Agreement",         "model_type": "text",         "search_tags":
                    "agreements,contracts,english,joint venture,partner,partnership"       },       {         "category_ref":
                    "nsLEGAL",         "description": "Detects nondisclosure agreements
                    in English.",         "dlp_license": "advanced",         "id":
                    "nda",         "label": "NDA (English ",         "model_type":
                    "text",         "search_tags": "agreements,cda,confidential disclosure
                    agreement,confidentiality,english,nda,ndas,non-disclosure,nondisclosure,nondisclosure
                    agreement,proprietary information agreement,secrecy agreement"       },       {         "category_ref":
                    "nsLEGAL",         "description": "Detects patent filings.",         "dlp_license":
                    "advanced",         "id": "patent-en_us",         "label": "Patent",         "model_type":
                    "text",         "search_tags": "english,filings,patents,trademark,uspto"       },       {         "category_ref":
                    "nsFINANCIAL",         "description": "Detects bank statements.",         "dlp_license":
                    "advanced",         "id": "bank_statement",         "label": "Bank
                    Statement",         "model_type": "text",         "search_refs":
                    [           "search/ban",           "search/us"         ],         "search_tags":
                    "bank statements,statement"       },       {         "category_ref":
                    "nsFINANCIAL",         "description": "Detects stock purchase
                    agreements between seller and buyer parties.",         "dlp_license":
                    "advanced",         "id": "stock_purchase_agreement",         "label":
                    "Stock Purchase Agreement",         "model_type": "text",         "search_tags":
                    "agreement,assets,certificates,purchase,shares,stock market,stocks"       },       {         "category_ref":
                    "nsSOURCECODE",         "description": "Detects any type of recognizable
                    source code.",         "dlp_license": "standard",         "id":
                    "source_code",         "label": "Source Code (All) ",         "model_type":
                    "text",         "search_refs": [           "search/srccode"         ],         "search_tags":
                    "asm,assembly,c code,c plus,c++,c-plus,cpp,java,javascript,python"       },       {         "category_ref":
                    "nsMEDICAL",         "description": "Detects medical power of
                    attorney (POA) documents, which may include advance directives
                    and living wills.",         "dlp_license": "advanced",         "id":
                    "medical_poa",         "label": "Medical Power of Attorney",         "model_type":
                    "text",         "search_tags": "advance directives,ahd,durable
                    power of attorney,english,health care proxy,healthcare proxy,legal,living
                    wills,medical,poa,power of attorney,powers of attorney"       },       {         "category_ref":
                    "nsPERSONALID",         "description": "Detects images of healthcare
                    ID cards.",         "dlp_license": "advanced",         "id": "healthcare_id_card",         "label":
                    "Healthcare ID Card",         "model_type": "image",         "search_tags":
                    "health,health care,health insurance,healthcare,insurance,medical,patient,patient
                    id,social insurance"       },       {         "category_ref":
                    "nsFINANCIAL",         "description": "Detects various forms of
                    financial instruments such as personal, business, and bank checks
                    and drafts.",         "dlp_license": "advanced",         "id":
                    "check",         "label": "Check",         "model_type": "image",         "search_tags":
                    "bank,cashier''s,cashiers,check,cheque,draft,money order,negotiable,teller''s,tellers,traveler''s,travelers,traveller''s,travellers"       },       {         "category_ref":
                    "nsPERSONALID",         "description": "Detects images of driver
                    licenses and state ID cards.",         "dlp_license": "advanced",         "id":
                    "driver_license",         "label": "Driver License (All) ",         "model_type":
                    "image",         "search_refs": [           "search/drivlic"         ]       },       {         "category_ref":
                    "nsPERSONALID",         "description": "Detects images of various
                    types of photo IDs.",         "dlp_license": "advanced",         "id":
                    "photo_id",         "label": "Photo ID",         "model_type":
                    "image"       },       {         "category_ref": "nsMEDICAL",         "description":
                    "Detects medical forms.",         "dlp_license": "advanced",         "id":
                    "medical_form",         "label": "Medical Form",         "model_type":
                    "text",         "search_tags": "english,health,health care,healthcare,hipaa,history,insurance,medical,patient,patient
                    data,patient info,patient registration,phi"       },       {         "category_ref":
                    "nsFINANCIAL",         "description": "Detects loan agreements.",         "dlp_license":
                    "advanced",         "id": "loan_agreement",         "label": "Loan
                    Agreement",         "model_type": "text",         "search_tags":
                    "auto loan,bank,bank loan,borrower,contracts,credit union,english,finance,financial,heloc,home
                    loans,housing,lender,loan agreements,mortgage,student loan"       },       {         "category_ref":
                    "nsMEDICAL",         "description": "Detects medical radiological
                    images, such as x-rays and CT/MRI scans.",         "dlp_license":
                    "advanced",         "id": "medical_image",         "label": "Medical
                    Image",         "model_type": "image",         "search_tags":
                    "computed tomography,ct scans,diagnostic,healthcare,imaging,magnetic
                    resonance,medical,mri,patient,radiographic,radiography,radiology,ultrasound,x
                    rays,x-rays,xrays"       },       {         "category_ref": "nsFINANCIAL",         "description":
                    "Detects consumer housing loan applications.",         "dlp_license":
                    "advanced",         "id": "loan_application",         "label":
                    "Loan Application",         "model_type": "text",         "search_tags":
                    "applications,bank,borrower,contracts,credit union,english,fannie
                    mae,finance,financial,freddie mac,home loans,housing,lender,loan
                    applications,mortgage,uhla"       }     ],     "search_data":
                    [       {         "data": "united states,america,american,usa,u.s.,us",         "id":
                    "search/us"       },       {         "data": "bank account numbers,account
                    numbers,acct,bankacct,bankaccount,bank account",         "id":
                    "search/ban"       },       {         "data": "driver,driving,drivers,driver''s,dl,license,licence,license
                    number,licence number,driverlicense,driver license,driving license",         "id":
                    "search/drivlic"       },       {         "data": "payment,payment
                    card,credit,credit card,debit,debit card,atm,ccn,card numbers",         "id":
                    "search/pan"       },       {         "data": "social,security,socsec,ssn,social
                    security,social security numbers",         "id": "search/ssn"       },       {         "data":
                    "sourcecode,source code,language,scripts,code,programming",         "id":
                    "search/srccode"       }     ]   },   "overlayCustomClassifiers":
                    [     {       "created": 1699672486759,       "description": "Wayne-Test-Predefined
                    Nov 11",       "id": "1953637428836194417",       "isPredefined":
                    true,       "lastTrained": 0,       "lastUploaded": 0,       "modifyBy":
                    "wxin@netskope.com",       "name": "_overlay_healthcare_id_card",       "overallStatus":
                    {         "invalid": 0,         "negative": 0,         "valid":
                    0       },       "profiles": null,       "region": null,       "status":
                    "created",       "threshold": 0.5,       "type": "image",       "updated":
                    1699672486759,       "version": 0     }   ] } '
              schema:
                $ref: "#/components/schemas/PredefinedClassifiersWithOverlayDto"
          description:
            The response has 2 lists, 'predefinedClassifiers' is a list
            of raw pre-defined classifiers and 'overlayCustomClassifiers' is a list
            of overlay custom classifiers each corresponds to a pre-defined classifier
        "404":
          content:
            text/plain:
              schema:
                type: string
          description: Not Found
        "500":
          content:
            text/plain:
              schema:
                type: string
          description: Internal Server Error
      summary: Get all predefined classifiers
      tags:
        - tyoc-v2
    put:
      description:
        Creating a custom classifier to overlay a predefined classifier
        requires the name to be the same as predefined classifier for a given tenant
        and a classifier ID will be returned for future reference
      operationId: gwCreateUpdatePredefined
      parameters: []
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PredefinedClassifierUserDto"
        required: true
      responses:
        "200":
          content:
            application/json:
              examples:
                Successful Response_1:
                  value:
                    ' {   "tenantId": null,   "id": "144294124833494081",   "name":
                    "_overlay_medical_image",   "status": "created",   "type": "image",   "description":
                    "test threshold level change",   "version": 0,   "region": null,   "modifyBy":
                    "wxin@netskope.com",   "isPredefined": true,   "threshold": 0,   "created":
                    1702782844179,   "updated": 1702921702261,   "lastTrained": 0,   "profiles":
                    null,   "thresholdLevel": "low" } '
              schema:
                $ref: "#/components/schemas/PredefinedOverlayDto"
          description:
            A classifier ID is returned and this could be used for classifier
            specific API
        "404":
          content:
            text/plain:
              schema:
                type: string
          description: Not Found
        "500":
          content:
            text/plain:
              schema:
                type: string
          description: Internal Server Error
      summary: Create or update an overlay custom classifier for a predefined classifier
      tags:
        - tyoc-v2
    x-netskope-params:
      apiGroup: tyoc
      customerFacing: true
      serviceConfig: dlp-fp-config
      version: 2
servers:
  - description: 8080 server on localhost
    url: http://localhost:8080
  - description: 28080 server on localhost
    url: http://localhost:28090
